'''
Dump stats about the data files generated by skantze_train.py.
Useful for sanity check that the data make sense.
'''
import numpy as np

import data_loading
import settings
import skantze_train

def session_part_generator(data):
    for session in data:
        for part in session['parts']:
            yield session, part


def main():
    data = data_loading.generator(settings.ANNOTATIONS_DIR, settings.AUDIO_DIR)
    for i, (session, part) in enumerate(session_part_generator(data)):
        X = np.load(skantze_train.DATA_DIR / f'X-{session["name"]}-{part["name"]}.npy')
        ys = np.load(skantze_train.DATA_DIR / f'ys-{session["name"]}-{part["name"]}.npy')

        print(session['name'], part['name'])
        features = ['voice activity', 'pitch relative', 'pitch absolute', 'voiced',
                    'power', 'spectral flux']
        for i, feature in enumerate(features):
            for j in range(2):
                vals = X[:, i * 2 + j]
                print(
                    f'{feature: >14}', j, '\t',
                    'mean:', f'{vals.mean(): >6.3f}',
                    'min:', f'{vals.min(): >6.3f}',
                    'max:', f'{vals.max(): >6.3f}',
                )

if __name__ == '__main__':
    main()
